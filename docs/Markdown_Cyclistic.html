<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Andrew Borozan" />


<title>Cyclistic Project</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/core-js-2.5.3/shim.min.js"></script>
<script src="site_libs/react-17.0.0/react.min.js"></script>
<script src="site_libs/react-17.0.0/react-dom.min.js"></script>
<script src="site_libs/reactwidget-1.0.0/react-tools.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/reactable-binding-0.2.3/reactable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">The Unlikely Analyst</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./Markdown_Cyclistic.html">Google Data Analytics Certification Project</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">How to Web Scrape in R: Part 1</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Blog
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">"I am crazy" and other thoughts that flitter through my head.</li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/githubusername/mywebsite">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Cyclistic Project</h1>
<h4 class="author">Andrew Borozan</h4>
<h4 class="date">2/10/2022</h4>

</div>


<div id="cyclistic-exploration" class="section level1">
<h1>Cyclistic Exploration</h1>
<p>The following is an exploration project completed at the end of my Google Data Analytics Certification. Here was the scenario:</p>
<p>You are a junior data analyst working in the marketing analyst team at Cyclistic, a bike-share company in Chicago. The director of marketing believes the company’s future success depends on maximizing the number of annual memberships. Therefore, your team wants to understand how casual riders and annual members use Cyclistic bikes differently. From these insights, your team will design a new marketing strategy to convert casual riders into annual members. But first, Cyclistic executives must approve your recommendations, so they must be backed up with compelling data insights and professional data visualizations.</p>
<p>The central business task of the project is to increase membership rates.</p>
<p>For the task to be completed, analysis must address the central question: How do annual members and casual riders use Cyclistic bikes differently?</p>
</div>
<div id="setup-r-environment" class="section level1">
<h1>Setup R Environment</h1>
<p>First, we will load the packages that will aid our data exploration. First, load the packman package, as there is a helpful function in this package that will load other packages needed in the environment.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(tidyverse, skimr, scales, rmarkdown, magrittr, lubridate, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>       janitor, htmltab, ggrepel, viridis, ggthemes, readxl, knitr, showtext,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>       showtextdb, reactable, patchwork)</span></code></pre></div>
</div>
<div id="loading-data" class="section level1">
<h1>Loading Data</h1>
<p>Next, we will load the data into R. The data comes from “Cyclistic” in the form of .csv files for each month. The data is anonymized so to protect individual user’s identities. Despite this anonymization, there is much to learned from behavioral patterns of casual riders and members. A majority of observations included values for each variable. Incomplete values were removed (detailed below). The .csv files were cleaned, in part, in Excel after creating a macro to be used for each month. The macro accomplished the following:</p>
<ul>
<li>Removed duplicates.</li>
<li>Trimmed and cleaned values in columns (removes extra characters and white space).</li>
<li>Created “ride_length” and “ride_length_hours” columns which provides the length of each ride in a time format and the length of the ride in hours.</li>
<li>Created a column for each the hour, minute, and seconds for each ride.</li>
<li>Created a column for the day number and day name for the start of each ride.</li>
</ul>
<p>We will put these Excel files into R and then combine them into one data frame. The resulting data frame can be seen below, including the different variables to be used in the analysis:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Cyclistic <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(Cyclistic_January, Cyclistic_February, Cyclistic_March, Cyclistic_April, Cyclistic_May, Cyclistic_June, Cyclistic_July, Cyclistic_August, Cyclistic_September, Cyclistic_October, Cyclistic_November, Cyclistic_December)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Cyclistic)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 21
##   ride_id          rideable_type started_at          ended_at           
##   &lt;chr&gt;            &lt;chr&gt;         &lt;dttm&gt;              &lt;dttm&gt;             
## 1 E19E6F1B8D4C42ED electric_bike 2021-01-23 16:14:19 2021-01-23 16:24:44
## 2 DC88F20C2C55F27F electric_bike 2021-01-27 18:43:08 2021-01-27 18:47:12
## 3 EC45C94683FE3F27 electric_bike 2021-01-21 22:35:54 2021-01-21 22:37:14
## 4 4FA453A75AE377DB electric_bike 2021-01-07 13:31:13 2021-01-07 13:42:55
## 5 BE5E8EB4E7263A0B electric_bike 2021-01-23 02:24:02 2021-01-23 02:24:45
## 6 5D8969F88C773979 electric_bike 2021-01-09 14:24:07 2021-01-09 15:17:54
## # ... with 17 more variables: ride_length &lt;dttm&gt;, ride_length_time &lt;dttm&gt;,
## #   ride_hour &lt;dbl&gt;, minute_length &lt;dbl&gt;, seconds_length &lt;dbl&gt;,
## #   ride_length_hours &lt;dbl&gt;, start_day &lt;dbl&gt;, start_day_name &lt;chr&gt;,
## #   start_station_name &lt;chr&gt;, start_station_id &lt;chr&gt;, end_station_name &lt;chr&gt;,
## #   end_station_id &lt;chr&gt;, start_lat &lt;dbl&gt;, start_lng &lt;dbl&gt;, end_lat &lt;dbl&gt;,
## #   end_lng &lt;dbl&gt;, member_casual &lt;chr&gt;</code></pre>
<p>We clean up the column names to make it easier to work with…</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Cyclistic <span class="ot">&lt;-</span> Cyclistic <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ride_length_time)</span></code></pre></div>
<p>And now, we start looking for some of the behavioral patterns of both members and casual riders.</p>
</div>
<div id="total-rides-and-average-length-of-ride" class="section level1">
<h1>Total rides and average length of ride</h1>
<p>First, we look at both the total number of rides by members and casual riders, and the average length of ride for each type of rider. We have to filter out any incomplete information on members and causal riders and length of ride.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>  member_casual_count <span class="ot">&lt;-</span> Cyclistic <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(member_casual, ride_length) <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">ride_time_avg =</span> <span class="fu">mean</span>(ride_length, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(ride_time_avg, <span class="at">ride_time_avg =</span> <span class="fu">format</span>(ride_time_avg, <span class="st">&#39;%H:%M:%S&#39;</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(<span class="fu">head</span>(member_casual_count))</span></code></pre></div>
<div id="htmlwidget-b3ad48ea8bb150ff63e3" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b3ad48ea8bb150ff63e3">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"member_casual":["casual","member"],"count":[2529005,3066058],"ride_time_avg":["00:32:01","00:13:38"]},"columns":[{"accessor":"member_casual","name":"member_casual","type":"character"},{"accessor":"count","name":"count","type":"numeric"},{"accessor":"ride_time_avg","name":"ride_time_avg","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"9994d531f8c8f7b90c652c2c4514b56e","key":"9994d531f8c8f7b90c652c2c4514b56e"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Something is wrong because some rides apparently went backwards through time:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>MinCyclistic <span class="ot">&lt;-</span> Cyclistic <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(member_casual, ride_length)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(Cyclistic<span class="sc">$</span>ride_length)</span></code></pre></div>
<pre><code>## [1] &quot;1899-12-30 23:01:58 UTC&quot;</code></pre>
<p>So we need to filter out rides that are a little unrealistic and get a data set full of rides that went from one station to another. This removes all records where the start and end station are the same (which shouldn’t be counted in the data set), and removes rides that claim they started after they ended.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Cyclistic_Drop_NA_Station_Ids <span class="ot">&lt;-</span> Cyclistic <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(start_station_id, end_station_id) <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(start_station_id <span class="sc">!=</span> end_station_id, started_at <span class="sc">&lt;</span> ended_at)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Cyclistic_Drop_NA_Station_Ids[<span class="fu">which.min</span>(Cyclistic_Drop_NA_Station_Ids<span class="sc">$</span>ride_length), ])</span></code></pre></div>
<pre><code>## Rows: 1
## Columns: 20
## $ ride_id            &lt;chr&gt; &quot;4344892ED6894278&quot;
## $ rideable_type      &lt;chr&gt; &quot;electric_bike&quot;
## $ started_at         &lt;dttm&gt; 2021-10-21 11:19:18
## $ ended_at           &lt;dttm&gt; 2021-10-21 11:19:19
## $ ride_length        &lt;dttm&gt; 1899-12-31 00:00:01
## $ ride_hour          &lt;dbl&gt; 0
## $ minute_length      &lt;dbl&gt; 0
## $ seconds_length     &lt;dbl&gt; 1
## $ ride_length_hours  &lt;dbl&gt; 0.0002777778
## $ start_day          &lt;dbl&gt; 5
## $ start_day_name     &lt;chr&gt; &quot;Thursday&quot;
## $ start_station_name &lt;chr&gt; &quot;Wabash Ave &amp; Grand Ave&quot;
## $ start_station_id   &lt;chr&gt; &quot;TA1307000117&quot;
## $ end_station_name   &lt;chr&gt; &quot;Dearborn St &amp; Erie St&quot;
## $ end_station_id     &lt;chr&gt; &quot;13045&quot;
## $ start_lat          &lt;dbl&gt; 41.89066
## $ start_lng          &lt;dbl&gt; -87.62626
## $ end_lat            &lt;dbl&gt; 41.89069
## $ end_lng            &lt;dbl&gt; -87.62633
## $ member_casual      &lt;chr&gt; &quot;casual&quot;</code></pre>
<p>Something still seems a little fishy. This says there was a ride between two stations that was only one second long. Either it is the fastest ride in history (that also breaks the laws of physics) or this is an error in the data. We need to filter again for reasonable ride lengths. While short, setting the minimum ride length to 30 seconds might filter out erroneous data.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Cyclistic_Drop_Ids_30 <span class="ot">&lt;-</span> Cyclistic <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(start_station_id, end_station_id) <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(start_station_id <span class="sc">!=</span> end_station_id, started_at <span class="sc">&lt;</span> ended_at, ride_length_hours <span class="sc">&gt;=</span> (<span class="dv">30</span><span class="sc">/</span><span class="dv">3600</span>)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ride_length)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(<span class="fu">head</span>(Cyclistic_Drop_Ids_30), <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-945f95efdef09ac1e8c4" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-945f95efdef09ac1e8c4">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"ride_id":["F0C1CC33209D584B","6A22C8A6BF0BD959","AD8A6AD0715EE0DF","48BBC4C8E0C5123E","D2413B51AE25965D","2B9F5C4B053A75CB"],"rideable_type":["classic_bike","classic_bike","classic_bike","classic_bike","classic_bike","classic_bike"],"started_at":["2021-06-28T19:08:19","2021-07-21T17:39:32","2021-07-15T16:50:25","2021-08-25T16:08:11","2021-09-23T14:00:54","2021-11-02T14:27:12"],"ended_at":["2021-06-28T19:08:49","2021-07-21T17:40:02","2021-07-15T16:50:55","2021-08-25T16:08:41","2021-09-23T14:01:24","2021-11-02T14:27:42"],"ride_length":["1899-12-31T00:00:30","1899-12-31T00:00:30","1899-12-31T00:00:30","1899-12-31T00:00:30","1899-12-31T00:00:30","1899-12-31T00:00:30"],"ride_hour":[0,0,0,0,0,0],"minute_length":[0,0,0,0,0,0],"seconds_length":[30,30,30,30,30,30],"ride_length_hours":[0.00833333333333333,0.00833333333333333,0.00833333333333333,0.00833333333333333,0.00833333333333333,0.00833333333333333],"start_day":[2,4,5,4,5,3],"start_day_name":["Monday","Wednesday","Thursday","Wednesday","Thursday","Tuesday"],"start_station_name":["Franklin St & Monroe St","Dayton St & North Ave","Halsted St & Clybourn Ave","Halsted St & Clybourn Ave","Franklin St & Adams St (Temp)","Franklin St & Adams St (Temp)"],"start_station_id":["TA1309000007","13058","331","331","TA1309000008","TA1309000008"],"end_station_name":["Franklin St & Adams St (Temp)","Halsted St & Clybourn Ave","Dayton St & North Ave","Dayton St & North Ave","Franklin St & Monroe St","Franklin St & Monroe St"],"end_station_id":["TA1309000008","331","13058","13058","TA1309000007","TA1309000007"],"start_lat":[41.880317,41.9105780349,41.909668,41.909668,41.8794340914001,41.8794340914001],"start_lng":[-87.635185,-87.6494219288,-87.648128,-87.648128,-87.6355040073394,-87.6355040073394],"end_lat":[41.8794340914001,41.909668,41.9105780349,41.9105780349,41.880317,41.880317],"end_lng":[-87.6355040073394,-87.648128,-87.6494219288,-87.6494219288,-87.635185,-87.635185],"member_casual":["member","member","member","member","casual","member"]},"columns":[{"accessor":"ride_id","name":"ride_id","type":"character"},{"accessor":"rideable_type","name":"rideable_type","type":"character"},{"accessor":"started_at","name":"started_at","type":"Date"},{"accessor":"ended_at","name":"ended_at","type":"Date"},{"accessor":"ride_length","name":"ride_length","type":"Date"},{"accessor":"ride_hour","name":"ride_hour","type":"numeric"},{"accessor":"minute_length","name":"minute_length","type":"numeric"},{"accessor":"seconds_length","name":"seconds_length","type":"numeric"},{"accessor":"ride_length_hours","name":"ride_length_hours","type":"numeric"},{"accessor":"start_day","name":"start_day","type":"numeric"},{"accessor":"start_day_name","name":"start_day_name","type":"character"},{"accessor":"start_station_name","name":"start_station_name","type":"character"},{"accessor":"start_station_id","name":"start_station_id","type":"character"},{"accessor":"end_station_name","name":"end_station_name","type":"character"},{"accessor":"end_station_id","name":"end_station_id","type":"character"},{"accessor":"start_lat","name":"start_lat","type":"numeric"},{"accessor":"start_lng","name":"start_lng","type":"numeric"},{"accessor":"end_lat","name":"end_lat","type":"numeric"},{"accessor":"end_lng","name":"end_lng","type":"numeric"},{"accessor":"member_casual","name":"member_casual","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"dataKey":"7304aadf17f767a0e0acbfb7a4d5da03","key":"7304aadf17f767a0e0acbfb7a4d5da03"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>That looks a little better. We can see a few 30 seconds rides that at least went from one station to another.</p>
<p>To see the maximum ride length…</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>maxride <span class="ot">&lt;-</span> Cyclistic[<span class="fu">which.max</span>(Cyclistic<span class="sc">$</span>ride_length), ]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(maxride)</span></code></pre></div>
<pre><code>## Rows: 1
## Columns: 20
## $ ride_id            &lt;chr&gt; &quot;F043F0F6A1AA4F85&quot;
## $ rideable_type      &lt;chr&gt; &quot;docked_bike&quot;
## $ started_at         &lt;dttm&gt; 2021-06-05 02:27:26
## $ ended_at           &lt;dttm&gt; 2021-07-13 22:51:35
## $ ride_length        &lt;dttm&gt; 1900-02-07 20:24:09
## $ ride_hour          &lt;dbl&gt; 932
## $ minute_length      &lt;dbl&gt; 24.63333
## $ seconds_length     &lt;dbl&gt; 9.633333
## $ ride_length_hours  &lt;dbl&gt; 932.4132
## $ start_day          &lt;dbl&gt; 7
## $ start_day_name     &lt;chr&gt; &quot;Saturday&quot;
## $ start_station_name &lt;chr&gt; &quot;Michigan Ave &amp; Lake St&quot;
## $ start_station_id   &lt;chr&gt; &quot;TA1305000011&quot;
## $ end_station_name   &lt;chr&gt; &quot;Malcolm X College Vaccination Site&quot;
## $ end_station_id     &lt;chr&gt; &quot;631&quot;
## $ start_lat          &lt;dbl&gt; 41.88602
## $ start_lng          &lt;dbl&gt; -87.62412
## $ end_lat            &lt;dbl&gt; 41.87762
## $ end_lng            &lt;dbl&gt; -87.6739
## $ member_casual      &lt;chr&gt; &quot;casual&quot;</code></pre>
<p>We get the start time and the end time, subtract the two to return the maximum “ride”:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>startmax <span class="ot">&lt;-</span> maxride<span class="sc">$</span>started_at</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>endmax <span class="ot">&lt;-</span> maxride<span class="sc">$</span>ended_at</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>endmax <span class="sc">-</span> startmax</span></code></pre></div>
<pre><code>## Time difference of 38.8501 days</code></pre>
<p>That’s a really long “ride.” The ride type though is “docked bike” meaning this was a bike that was just sitting around for 38 days. If we take a look, docked bikes are only attributed to casual riders, possibly suggesting docked bikes don’t get tracked for members.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Docked_Bike_Count <span class="ot">&lt;-</span> Cyclistic <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(member_casual, rideable_type) <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rideable_type <span class="sc">==</span> <span class="st">&quot;docked_bike&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(Docked_Bike_Count, <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-ddfbd09fa92c231a692e" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ddfbd09fa92c231a692e">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"member_casual":["casual","member"],"rideable_type":["docked_bike","docked_bike"],"count":[312342,1]},"columns":[{"accessor":"member_casual","name":"member_casual","type":"character"},{"accessor":"rideable_type","name":"rideable_type","type":"character"},{"accessor":"count","name":"count","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"dataKey":"f7799411e4ea350ed64f87848be9f44a","key":"f7799411e4ea350ed64f87848be9f44a"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>We are going to filter out docked bikes as it seems it will not tell us much about the differences in behavior between members and causal riders, and therefore, gain us little achieving our primary objective.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Cyclistic <span class="ot">&lt;-</span> Cyclistic  <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rideable_type <span class="sc">!=</span> <span class="st">&quot;docked_bike&quot;</span>)</span></code></pre></div>
<p>Though we are filtering out docked bikes, this might be a note for marketing strategy. Highlighting the benefit of membership to casual riders who dock frequently and/or for long periods of time might increase rates of membership. All docked ride types are from casual riders (after excluding the one member, which is presumed to be a faulty data point).</p>
<p>Now that we have a data set that has removed incomplete information from members_casual, end_station and start_station ids, and ride_lengths, and we have removed docked bikes, we have a collection of data that can tell us something about the behavior of both members and casual riders. We have already seen that casual riders have much longer ride times on average than members. But that had included docked bikes in the data. What happens when we exclude docked bikes from the data?</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Cyclistic <span class="ot">&lt;-</span> Cyclistic <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(member_casual, end_station_id, start_station_id, ride_length) <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(start_station_id <span class="sc">!=</span> end_station_id, started_at <span class="sc">&lt;</span> ended_at, ride_length_hours <span class="sc">&gt;=</span> (<span class="dv">30</span><span class="sc">/</span><span class="dv">3600</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>new_count <span class="ot">&lt;-</span> Cyclistic <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(member_casual) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">number_of_rides =</span> <span class="fu">n</span>(), <span class="at">ride_time_avg =</span> <span class="fu">mean</span>(ride_length, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(ride_time_avg, <span class="at">ride_time_avg =</span> <span class="fu">format</span>(ride_time_avg, <span class="st">&#39;%H:%M:%S&#39;</span>))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(new_count, <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-69608f6f3c0d3efc91bb" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-69608f6f3c0d3efc91bb">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"member_casual":["casual","member"],"number_of_rides":[1574629,2428629],"ride_time_avg":["00:22:51","00:13:05"]},"columns":[{"accessor":"member_casual","name":"member_casual","type":"character"},{"accessor":"number_of_rides","name":"number_of_rides","type":"numeric"},{"accessor":"ride_time_avg","name":"ride_time_avg","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"dataKey":"4f8e16abffc680f7fc986cb3183fdfdf","key":"4f8e16abffc680f7fc986cb3183fdfdf"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>We can see a decrease in the amount of rides and average ride time (especially for casual riders), but this data is more robust and includes information we need for analysis.</p>
<p>Visually, the data looks like this:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="st">&quot;Exo&quot;</span>, <span class="st">&quot;exo&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>number <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(new_count, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> member_casual, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> number_of_rides, <span class="at">fill =</span> member_casual)) <span class="sc">+</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure scales package enabled so the label = comma(count) works.</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">comma</span>(number_of_rides)), </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust=</span> .<span class="dv">5</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">15</span>, </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="st">&quot;exo&quot;</span>, </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span> </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Rider Status&quot;</span>, </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Number of Rides&quot;</span>, </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title  =</span> <span class="st">&quot;Cyclistic Rides by Rider Status&quot;</span>) <span class="sc">+</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the following puts labels in thousands on y-axis (label = scales::comma)</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and makes sure the graph starts on the axis. &quot;limits =&quot; sets the limit of the axis.</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3500000</span>))<span class="sc">+</span>  </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;indianred1&quot;</span>, <span class="st">&quot;goldenrod1&quot;</span>))<span class="sc">+</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;exo&quot;</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>length <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(new_count, </span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> member_casual, </span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> ride_time_avg, </span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> member_casual)) <span class="sc">+</span> </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> ride_time_avg), </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust=</span> .<span class="dv">5</span>,</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">15</span>,</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="st">&quot;exo&quot;</span>,</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">4.5</span>) <span class="sc">+</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Rider Status&quot;</span>, </span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average Length of Ride in Minutes&quot;</span>, </span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">title  =</span> <span class="st">&quot;Average Length of Ride by Rider Status&quot;</span>) <span class="sc">+</span> </span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;indianred1&quot;</span>, <span class="st">&quot;goldenrod1&quot;</span>))<span class="sc">+</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;exo&quot;</span>, <span class="at">size =</span> <span class="dv">20</span>))</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>number <span class="sc">/</span> length</span></code></pre></div>
<p><img src="Markdown_Cyclistic_files/figure-html/Total%20rides%20by%20rider%20type-1.png" width="672" /></p>
</div>
<div id="most-popular-stations" class="section level1">
<h1>Most Popular Stations</h1>
<p>Which stations are the most popular launching points for each type of rider?</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Pop_Station_Name <span class="ot">&lt;-</span> Cyclistic <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(start_station_name, start_station_id, member_casual) <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">select</span>(start_station_name, start_station_id, member_casual, count) </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(<span class="fu">head</span>(Pop_Station_Name, <span class="dv">10</span>), <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-84c2289af3b7483358b9" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-84c2289af3b7483358b9">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"start_station_name":["2112 W Peterson Ave","2112 W Peterson Ave","63rd St Beach","63rd St Beach","900 W Harrison St","900 W Harrison St","Aberdeen St & Jackson Blvd","Aberdeen St & Jackson Blvd","Aberdeen St & Monroe St","Aberdeen St & Monroe St"],"start_station_id":["KA1504000155","KA1504000155","15491","15491","13028","13028","13157","13157","13156","13156"],"member_casual":["casual","member","casual","member","casual","member","casual","member","casual","member"],"count":[292,475,501,509,1889,5398,2892,7669,2853,6765]},"columns":[{"accessor":"start_station_name","name":"start_station_name","type":"character"},{"accessor":"start_station_id","name":"start_station_id","type":"character"},{"accessor":"member_casual","name":"member_casual","type":"character"},{"accessor":"count","name":"count","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"dataKey":"f5035c61b193912d69553272191d49d0","key":"f5035c61b193912d69553272191d49d0"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>This table provides information that gives the starting station name, starting station id, whether the user was a member or a casual rider, and the number of rides started from that station based on whether the user was a member or casual rider. This is a very useful data frame from which we can draw important information.</p>
<p>For instance, we can identify the top ten starting stations for casual riders:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>casual_10 <span class="ot">&lt;-</span> Pop_Station_Name <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(member_casual, <span class="fu">desc</span>(count))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>casual_top_10 <span class="ot">&lt;-</span> <span class="fu">head</span>(casual_10, <span class="dv">10</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>table_casual_top_10 <span class="ot">&lt;-</span> <span class="fu">reactable</span>(casual_top_10, <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>chart_casual_top_10 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(casual_top_10, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(start_station_name, count), <span class="at">y =</span> count, <span class="at">fill =</span> count)) <span class="sc">+</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> count), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">6</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust=</span> .<span class="dv">5</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">1</span>, </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="st">&quot;exo&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Number of Rides&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Start Station Name&quot;</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title  =</span> <span class="st">&quot;Most Popular Start Stations for Casual Riders&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50000</span>)) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;exo&quot;</span>, <span class="at">size =</span> <span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>table_casual_top_10</span></code></pre></div>
<div id="htmlwidget-706c7f6f00a49e6ea5bc" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-706c7f6f00a49e6ea5bc">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"start_station_name":["Streeter Dr & Grand Ave","Millennium Park","Michigan Ave & Oak St","Wells St & Concord Ln","Theater on the Lake","Wells St & Elm St","Clark St & Elm St","Shedd Aquarium","Clark St & Lincoln Ave","Clark St & Armitage Ave"],"start_station_id":["13022","13008","13042","TA1308000050","TA1308000001","KA1504000135","TA1307000039","15544","13179","13146"],"member_casual":["casual","casual","casual","casual","casual","casual","casual","casual","casual","casual"],"count":[38508,18721,17997,16620,14052,14046,13577,13571,13356,12348]},"columns":[{"accessor":"start_station_name","name":"start_station_name","type":"character"},{"accessor":"start_station_id","name":"start_station_id","type":"character"},{"accessor":"member_casual","name":"member_casual","type":"character"},{"accessor":"count","name":"count","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"dataKey":"7c7b66acc5b2b3fde5893bcb1552484f","key":"7c7b66acc5b2b3fde5893bcb1552484f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>chart_casual_top_10</span></code></pre></div>
<p><img src="Markdown_Cyclistic_files/figure-html/Top%2010%20Starting%20Stations%20for%20Casual%20Riders-2.png" width="672" /></p>
<p>And the top 10 starting stations for members:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>member_10 <span class="ot">&lt;-</span> Pop_Station_Name <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(member_casual), <span class="fu">desc</span>(count))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>member_top_10 <span class="ot">&lt;-</span> <span class="fu">head</span>(member_10, <span class="dv">10</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>table_member_top_10 <span class="ot">&lt;-</span> <span class="fu">reactable</span>(member_top_10, <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>chart_member_top_10 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(member_top_10, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(start_station_name, count), <span class="at">y =</span> count, <span class="at">fill =</span> count)) <span class="sc">+</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> count), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">6</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust=</span> .<span class="dv">5</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">1</span>, </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="st">&quot;exo&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Number of Rides&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Start Station Name&quot;</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">title  =</span> <span class="st">&quot;Most Popular Start Stations for Members&quot;</span>) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the following puts labels in thousands on y-axis (label = scales::comma)</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and makes sure the graph starts on the axis. &quot;limits =&quot; sets the limit of the axis.</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">28000</span>)) <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;exo&quot;</span>, <span class="at">size =</span> <span class="dv">17</span>))  <span class="sc">+</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>table_member_top_10</span></code></pre></div>
<div id="htmlwidget-5edf5e4d7a8d2f724b2d" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5edf5e4d7a8d2f724b2d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"start_station_name":["Clark St & Elm St","Kingsbury St & Kinzie St","Wells St & Concord Ln","Wells St & Elm St","Dearborn St & Erie St","Wells St & Huron St","St. Clair St & Erie St","Broadway & Barry Ave","Clinton St & Madison St","Desplaines St & Kinzie St"],"start_station_id":["TA1307000039","KA1503000043","TA1308000050","KA1504000135","13045","TA1306000012","13016","13137","TA1305000032","TA1306000003"],"member_casual":["member","member","member","member","member","member","member","member","member","member"],"count":[23076,22142,22086,19535,17801,17703,17631,16142,15979,15664]},"columns":[{"accessor":"start_station_name","name":"start_station_name","type":"character"},{"accessor":"start_station_id","name":"start_station_id","type":"character"},{"accessor":"member_casual","name":"member_casual","type":"character"},{"accessor":"count","name":"count","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"dataKey":"e8da3e0fb893f69f92c3cb49e2b466a7","key":"e8da3e0fb893f69f92c3cb49e2b466a7"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>chart_member_top_10</span></code></pre></div>
<p><img src="Markdown_Cyclistic_files/figure-html/Top%2010%20Starting%20Station%20for%20Members-2.png" width="672" /></p>
<p>If Cyclistic’s goal is to increase membership, an advertising blitz in the areas in these top 10 lists would be advised. Of particular note is the number one spot for casual riders, Streeter Dr. &amp; Grand Ave. It has twice as many trips as the next most popular spot, Millennium Park. Despite these eye-popping, and maybe suspicious, numbers, the data fits the context: the Streeter Dr. &amp; Grand Ave. station is the station at Navy Pier, one of the most popular tourist destinations in Chicago.</p>
<p>The start station areas with high volumes of users might be areas ripe for marketing. So might the areas around start stations with high volumes of casual riders that also have long ride times. For casual riders, let’s see what high volume start stations (over 500 rides) have the longest ride times.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>casual_avg_ride_length <span class="ot">&lt;-</span> Cyclistic <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(start_station_name, end_station_name, member_casual, ride_length) <span class="sc">%&gt;%</span>  <span class="fu">group_by</span>(start_station_name, member_casual) <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(member_casual <span class="sc">==</span> <span class="st">&quot;casual&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">avg_ride_length =</span> <span class="fu">mean</span>(ride_length)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;=</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(avg_ride_length, <span class="at">avg_ride_length =</span> <span class="fu">format</span>(avg_ride_length, <span class="st">&#39;%H:%M:%S&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(start_station_name, count, member_casual, avg_ride_length) <span class="sc">%&gt;%</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_ride_length))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>casual_avg_ride_length_top10 <span class="ot">&lt;-</span> <span class="fu">head</span>(casual_avg_ride_length, <span class="dv">10</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(casual_avg_ride_length_top10, <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-ecc2ecbd6c313810ee66" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ecc2ecbd6c313810ee66">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"start_station_name":["Museum of Science and Industry","63rd St Beach","Millennium Park","Lake Park Ave & 35th St","Buckingham Fountain","Lake Shore Dr & Monroe St","Fort Dearborn Dr & 31st St","Sheridan Rd & Loyola Ave","Lake Park Ave & 53rd St","DuSable Lake Shore Dr & Monroe St"],"count":[2065,501,18721,814,6278,9688,2412,1479,2255,9271],"member_casual":["casual","casual","casual","casual","casual","casual","casual","casual","casual","casual"],"avg_ride_length":["00:47:29","00:42:41","00:38:10","00:38:09","00:37:35","00:37:25","00:36:19","00:35:59","00:35:55","00:35:40"]},"columns":[{"accessor":"start_station_name","name":"start_station_name","type":"character"},{"accessor":"count","name":"count","type":"numeric"},{"accessor":"member_casual","name":"member_casual","type":"character"},{"accessor":"avg_ride_length","name":"avg_ride_length","type":"character"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"dataKey":"67866cad366bf0ef2242166cf62d51e2","key":"67866cad366bf0ef2242166cf62d51e2"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Are there any stations that make an appearance in both the top 10 number of a casual rides and the top 10 average length of ride?</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>casual_top_10s <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(casual_top_10, casual_avg_ride_length_top10, <span class="st">&quot;start_station_name&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>casual_top_10s</span></code></pre></div>
<pre><code>## # A tibble: 1 x 7
## # Groups:   start_station_name, start_station_id [1]
##   start_station_name start_station_id member_casual.x count.x count.y
##   &lt;chr&gt;              &lt;chr&gt;            &lt;chr&gt;             &lt;int&gt;   &lt;int&gt;
## 1 Millennium Park    13008            casual            18721   18721
## # ... with 2 more variables: member_casual.y &lt;chr&gt;, avg_ride_length &lt;chr&gt;</code></pre>
<p>There is one overlaping start station between the top 10 start stations for casual riders by volume and the top 10 start stations for causal riders by average ride time: Millennium Park. A unique marketing strategy for Millennium Park might be beneficial, while Cyclistic might want to take different marketing angles towards the different stations on the respective lists above.</p>
</div>
<div id="days-of-the-week" class="section level1">
<h1>Days of the Week</h1>
<p>Let’s now take a look at days of the week. Should Cyclistic focus advertising efforts on certain days of the week for casual riders? Are members more inclined to ride on weekdays or weekends?</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>days_of_week <span class="ot">&lt;-</span> Cyclistic <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(member_casual, start_day, start_day_name) <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(<span class="fu">head</span>(days_of_week, <span class="dv">14</span>), <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-c3ea1cff733e3b4b845d" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c3ea1cff733e3b4b845d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"member_casual":["casual","casual","casual","casual","casual","casual","casual","member","member","member","member","member","member","member"],"start_day":[1,2,3,4,5,6,7,1,2,3,4,5,6,7],"start_day_name":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],"count":[298277,171461,167433,173436,180401,227835,355786,294667,330742,372154,381888,358679,350385,340114]},"columns":[{"accessor":"member_casual","name":"member_casual","type":"character"},{"accessor":"start_day","name":"start_day","type":"numeric"},{"accessor":"start_day_name","name":"start_day_name","type":"character"},{"accessor":"count","name":"count","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"highlight":true,"bordered":true,"dataKey":"89392769588111c508c655e4326e3e93","key":"89392769588111c508c655e4326e3e93"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>We can take a look at this and see…</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>days_of_week <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(days_of_week) <span class="sc">%&gt;%</span>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>start_day_name, <span class="at">y =</span> count, <span class="at">fill =</span> member_casual)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">comma</span>(count)), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">vjust=</span> .<span class="dv">5</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">hjust =</span> <span class="fl">1.15</span>, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">family =</span> <span class="st">&quot;exo&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Number of Rides&quot;</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">title  =</span> <span class="st">&quot;Number of Rides by Day of Week&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># expand_limits(y=c(0, 50000)) +</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># put the discrete variables in the order you want them. </span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;Saturday&quot;</span>, <span class="st">&quot;Friday&quot;</span>, <span class="st">&quot;Thursday&quot;</span>, <span class="st">&quot;Wednesday&quot;</span>, <span class="st">&quot;Tuesday&quot;</span>, <span class="st">&quot;Monday&quot;</span>, <span class="st">&quot;Sunday&quot;</span>)) <span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;indianred1&quot;</span>, <span class="st">&quot;goldenrod1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;exo&quot;</span>, <span class="at">size =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> member_casual)</span></code></pre></div>
<p><img src="Markdown_Cyclistic_files/figure-html/Rides%20by%20Day%20of%20Week%20Visualized-1.png" width="672" /></p>
<p>…that casual riders are more likely to ride on the weekends. If targeting casual riders, advertising on the weekends is recommended.</p>
</div>
<div id="time-of-day-by-day-of-week" class="section level1">
<h1>Time of Day by Day of Week</h1>
<p>Another avenue to explore is time of day to target casual riders. We can accomplish this by taking a look at the time of day both members and casual riders are typically beginning their rides.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Cyclistic_hour_start <span class="ot">&lt;-</span> Cyclistic <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">start_hour =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(started_at, <span class="st">&quot;%H&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">transform</span> (<span class="at">start_day_name =</span> <span class="fu">factor</span>(start_day_name,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Sunday&quot;</span>, <span class="st">&quot;Monday&quot;</span>, <span class="st">&quot;Tuesday&quot;</span>, <span class="st">&quot;Wednesday&quot;</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                                                            <span class="st">&quot;Thursday&quot;</span>, <span class="st">&quot;Friday&quot;</span>, <span class="st">&quot;Saturday&quot;</span>)))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>Cyclistic_hour_start <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> start_hour, <span class="at">fill =</span> member_casual)) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Start Hour&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of Rides&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Number of Rides by Hour&quot;</span>, </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;By Day&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30000</span>, <span class="dv">60000</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">75000</span>))<span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;indianred1&quot;</span>, <span class="st">&quot;goldenrod1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;exo&quot;</span>), </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;lines&quot;</span>)) <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> start_day_name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="Markdown_Cyclistic_files/figure-html/Time%20of%20Day%20for%20Casual%20Riders%20and%20Members-1.png" width="672" /></p>
<p>We see from these visualizations that people tend to sleep in on the weekends, but also causal rider traffic is most heavy in the middle of the day on Saturday and Sunday. On weekdays, casual riders traffic increases throughout the day, peaking in late afternoon or early evening. Advertising efforts should focus their efforts on these high traffic hour windows.</p>
</div>
<div id="interactive-map-on-tableau" class="section level1">
<h1>Interactive Map on Tableau</h1>
<p>Finally, <a href="https://public.tableau.com/views/Top20StationswithMap/Top20withMap?:language=en-US&amp;publish=yes&amp;:display_count=n&amp;:origin=viz_share_link">here is a link to an interactive dashboard on Tableau.</a> The top 20 start stations by total number of rides are given, along with the total hours ridden from each station. One can filter by rider type at the top. An interactive map is also included which shows number of rides by station (minimum of 100 rides). The rider type filter at the top also applies to the data presented in the map.</p>
<p>Useful information to be gleaned from the dashboard:</p>
<ul>
<li><p>Not surprisingly, casual riders are practically non-existent in the months of January and February. Advertising directed at casual riders during this time is ill-advised.</p></li>
<li><p>There is a swell of casual riders during the summer months, particular around popular tourist destinations.</p></li>
<li><p>There is increased activity among members along Ellis Ave, south of the city center, during the fall months. The area of increased activity is in the vicinity of the University of Chicago medical complex. The increased rate could be tied to Covid cases and/or testing, but this information could be used to target casual riders as well, highlighting easy accessibility to health care facilities.</p></li>
</ul>
<p>*Because of imprecision in latitude and longitude data in the original data set, some ride totals may be slightly different than what is presented above. Some station names did not match the latitude and longitude coordinates, therefore there is some information missing, such as the Shedd Aquarium station from the top 20 stations for casual riders. Most of the same information from above was captured however, and the general conclusions remain the same.</p>
</div>
<div id="moving-forward" class="section level1">
<h1>Moving Forward</h1>
<p>The primary objective of the analysis was to determine behavioral differences between casual riders and members. After completing this analysis, the following behavioral differences were identified:</p>
<ul>
<li><p>Casual riders have longer ride times on average than members</p></li>
<li><p>Many top 10 start stations by number of rides for casual riders are popular tourist destinations throughout city. Only two stations from the casual top 10 stations overlap with the top 10 stations for members.</p></li>
<li><p>There is a disproportionate number of rides for casual riders on the weekend - 41.5% of rides for casual riders came on Saturday and Sunday - compared to members - only 26.1% of rides for members came on Saturday and Sunday.</p></li>
<li><p>Most weekday rides for casual riders begin late afternoon to early evening. Most weekend rides begin midday through afternoon. This is in contrast to riders who are members who have higher number of rides during weekday mornings.</p></li>
<li><p>There is a higher volume of casual riders in the summer months.</p></li>
</ul>
<div id="deductions-and-recommendations" class="section level2">
<h2>Deductions and Recommendations</h2>
<p>It seems as if many casual riders are tourists, as gleaned from the volume of rides by time of year and popular start stations. It will be difficult to convince one-off weekend riders to sign up for a Cyclistic membership. Strategies to combat this challenge include:</p>
<ul>
<li><p>Partnering with other business or services and presenting membership as part of a packaged deal.</p></li>
<li><p>Offering short-term membership options. If the only membership option is yearly, 3 month membership options might be more appealing to casual riders.</p></li>
</ul>
<p>Marketing strategies have been suggested throughout the project, but one further strategy is dependent on how casual riders are currently charged.</p>
<ul>
<li><p>If casual riders are charged by ride, adverstising efforts should be directed toward high volume stations for casual riders - Streeter Dr. &amp; Grand Ave., Millennium Park, Michigan Ave. &amp; Oak St., etc. Highlight the benefit of membership for number of rides.</p></li>
<li><p>If casual riders are charged by length of ride, advertising efforts should be directed toward stations with long ride times - Museum of Science and Industry, 63rd St. Beach, etc. Highlight the benefit of membership for long ride times. If Cyclistic has an app, push notifications could be used to inform the rider how much money they would have saved on their long ride with a membership.</p></li>
</ul>
<p>One possible avenue of further exploration is presence of other bike sharing ventures in other urban areas. A packaged deal for membership with other bike share ventures (similar to a previous suggestion) could entice casual riders to pursue membership. More data on bike share ventures in other urban areas would be needed for this analysis.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
